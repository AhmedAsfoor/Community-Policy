{
    "name":"audit-role-assignments-principaltype",
    "properties":{
       "displayName":"Audit Role Assignments For Specific Principal Type",
       "description":"This policy audits for any Role Assignments for a specific Principal Type (e.g. User/Group/ServicePrincipal).",
       "mode":"All",
       "parameters":{
          "principalType":{
             "type":"String",
             "metadata":{
                "description":"Which principalType to audit against e.g. 'User, Group, ServicePrincipal'",
                "displayName":"principalType"
             },
             "allowedValues":[
                "User",
                "Group",
                "ServicePrincipal"
             ],
             "defaultValue":"User"
          }
       },
       "policyRule":{
          "if":{
             "allOf":[
                {
                   "equals":"Microsoft.Authorization/roleAssignments",
                   "field":"type"
                },
                {
                   "equals":"[parameters('principalType')]",
                   "field":"Microsoft.Authorization/roleAssignments/principalType"
                }
             ]
          },
          "then":{
             "effect":"audit"
          }
       }
    }
}